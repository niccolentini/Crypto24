from requests import *


url1 = "http://130.192.5.212:6522/login"
url2 = "http://130.192.5.212:6522/flag"

flag_found = False
while not flag_found:  # exploiting the fact that the random generator could generate a valid date...

    session = Session()

    r = session.get(url1, params={"username":"admin", "admin":1})

    print(r.text)

    nonce = r.json()["nonce"]
    cookie = r.json()["cookie"]


    print(nonce, cookie)

    x = session.get(url2, params={"nonce":nonce, "cookie":cookie})

    if "flag" in x.text or "CRYPTO24" in x.text:
        flag_found = True

    print(x.text)