from pwn import *

r = connect('130.192.5.212', 6531)

for _ in range(128):

    # Read until "I'm using: "

    r.recvuntil(b"I'm using: ")

    # Read next string in bytes

    # receive an hex string and convert it to bytes

    otp = r.recvline().strip().decode()

    # Read until "Input: "
    r.recvuntil(b"Input: ")

    # sent otp
    r.sendline(otp.encode())
    
    # Read until "Output: "
    r.recvuntil(b"Output: ")

    # Read next line
    result = r.recvline().strip().decode()

    if result[:32] == result[32:]:
        r.sendline(b'ECB')
    else:
        r.sendline(b'CBC')

r.interactive()

