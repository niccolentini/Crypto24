from pwn import *

# Connect to the server

r = remote('130.192.5.212', 6532)

'''
QUI GLI MANDIAMO TUTTE A E POI VEDIAMO SE IL CIPHERTEXT CAMBIA O NO. SE CAMBIA ALLORA E' CBC ALTRIMENTI E' ECB
'''

payload = 'AA' * 32

for i in range(128):
    r.recvuntil(b'Input: ')
    r.sendline(payload.encode())
    cipher1 = r.recvline().strip().decode()

    r.recvuntil(b'Input: ')
    r.sendline(payload.encode())
    cipher2 = r.recvline().strip().decode()

    r.recvuntil(b'What mode did I use? (ECB, CBC)\n')

    if cipher1 == cipher2:
        r.sendline(b'ECB')
        print("ECB")
    else:
        r.sendline(b'CBC') # since cbc uses a random IV each time, the ciphers will be different
        print("CBC")

r.interactive()
